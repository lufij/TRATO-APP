# üîä SISTEMA AVANZADO DE NOTIFICACIONES SONORAS

## üìã Descripci√≥n General

El sistema avanzado de notificaciones sonoras est√° dise√±ado para garantizar que los usuarios de la comunidad nunca pierdan notificaciones importantes, incluso con la pantalla apagada o en dispositivos m√≥viles.

## ‚ú® Caracter√≠sticas Principales

### üéµ Sonidos Optimizados
- **Frecuencias Audibles**: Tonos entre 440Hz y 1200Hz optimizados para m√°xima audibilidad
- **Patrones Inteligentes**: Single, doble, triple y continuo seg√∫n la importancia
- **Repeticiones Autom√°ticas**: Notificaciones importantes se repiten autom√°ticamente
- **Volumen Din√°mico**: Control de volumen independiente por tipo de notificaci√≥n

### üì± Compatibilidad M√≥vil
- **Vibraci√≥n Inteligente**: Patrones de vibraci√≥n espec√≠ficos por tipo de notificaci√≥n
- **Funcionamiento en Segundo Plano**: Service Worker para notificaciones con pantalla apagada
- **Push Notifications**: Notificaciones del navegador que aparecen en la pantalla de bloqueo
- **Activaci√≥n Autom√°tica**: Se activa autom√°ticamente con cualquier interacci√≥n del usuario

### üéØ Notificaciones por Rol

#### üë®‚Äçüíº **VENDEDORES**
1. **üõí Nueva Orden** (Prioridad ALTA)
   - Sonido: 880Hz, patr√≥n triple, 3 repeticiones cada 2 segundos
   - Vibraci√≥n: [400, 200, 400, 200, 400]
   - Push: Requiere interacci√≥n del usuario
   - Mensaje: "Cliente: [Nombre] - Q[Total]"

2. **üöö Repartidor Asignado** (Prioridad NORMAL)
   - Sonido: 660Hz, patr√≥n doble, 2 repeticiones cada 1.5 segundos  
   - Vibraci√≥n: [300, 150, 300]
   - Push: Se cierra autom√°ticamente en 10s
   - Mensaje: "Pedido #[ID] en camino"

3. **‚úÖ Entrega Completada** (Prioridad BAJA)
   - Sonido: 440Hz, patr√≥n √∫nico, 1 repetici√≥n
   - Vibraci√≥n: [500]
   - Push: Se cierra autom√°ticamente en 10s
   - Mensaje: "Pedido #[ID] completado"

#### üöö **REPARTIDORES**
1. **üì¶ Entrega Disponible** (Prioridad ALTA)
   - Sonido: 1000Hz, patr√≥n triple, 3 repeticiones cada 1.5 segundos
   - Vibraci√≥n: [250, 100, 250, 100, 250]
   - Push: Requiere interacci√≥n del usuario
   - Mensaje: "Entrega para: [Cliente] - [Direcci√≥n]"

2. **üéØ Entrega Asignada** (Prioridad NORMAL)
   - Sonido: 660Hz, patr√≥n doble, 2 repeticiones cada 1.5 segundos
   - Vibraci√≥n: [300, 150, 300]
   - Push: Se cierra autom√°ticamente en 10s
   - Mensaje: "Tienes una nueva entrega asignada"

#### üõçÔ∏è **COMPRADORES**
1. **üöö Repartidor Asignado** (Prioridad NORMAL)
   - Sonido: 660Hz, patr√≥n doble, 2 repeticiones
   - Vibraci√≥n: [300, 150, 300]
   - Push: Se cierra autom√°ticamente en 10s
   - Mensaje: "Un repartidor est√° en camino"

2. **‚úÖ Pedido Entregado** (Prioridad NORMAL)
   - Sonido: 440Hz, patr√≥n √∫nico, 1 repetici√≥n
   - Vibraci√≥n: [500]
   - Push: Se cierra autom√°ticamente en 10s
   - Mensaje: "Tu pedido ha sido entregado exitosamente"

3. **üÜï Nuevo Producto** (Prioridad BAJA)
   - Sonido: 784Hz, patr√≥n √∫nico, 1 repetici√≥n
   - Vibraci√≥n: [200]
   - Push: Se cierra autom√°ticamente en 5s
   - Mensaje: "Nuevo producto disponible"

## üîß Instalaci√≥n y Configuraci√≥n

### 1. Activaci√≥n Autom√°tica
El sistema se activa autom√°ticamente cuando el usuario visita la aplicaci√≥n. Para activaci√≥n manual:

```javascript
// Ejecutar en la consola del navegador
window.activateAdvancedNotifications();
```

### 2. Funciones Disponibles

#### Sonidos B√°sicos
```javascript
// Reproducir sonido espec√≠fico
window.playAdvancedNotificationSound({
  frequency: 880,      // Frecuencia en Hz
  duration: 400,       // Duraci√≥n en ms
  pattern: 'triple',   // 'single', 'double', 'triple', 'critical'
  volume: 0.8,         // 0.0 a 1.0
  repeatCount: 3,      // N√∫mero de repeticiones
  repeatInterval: 2000 // Intervalo entre repeticiones (ms)
});
```

#### Notificaciones Completas
```javascript
// Nueva orden (vendedores)
window.notifyNewOrder({
  id: "order123",
  customer_name: "Juan P√©rez",
  total: 25.50,
  delivery_type: "delivery"
});

// Repartidor asignado
window.notifyDriverAssigned({
  id: "order123",
  customer_name: "Juan P√©rez"
});

// Entrega disponible (repartidores)
window.notifyDeliveryAvailable({
  id: "order123",
  customer_name: "Juan P√©rez",
  delivery_address: "Zone 10, Guatemala",
  total: 25.50
});

// Pedido entregado
window.notifyOrderDelivered({
  id: "order123"
});

// Alerta cr√≠tica
window.notifyCritical("Sistema sobrecargado", {
  priority: "critical"
});
```

#### Pruebas del Sistema
```javascript
// Prueba completa del sistema
window.testAdvancedNotifications();

// Activar/desactivar sonidos en segundo plano
window.enableBackgroundNotifications();
window.disableBackgroundNotifications();
```

## üéõÔ∏è Panel de Control

### Acceso al Panel
1. Ir a cualquier dashboard de la aplicaci√≥n
2. Clic en el √≠cono de campana (üîî) en la esquina superior derecha
3. Clic en el bot√≥n "üîä Sonidos"

### Funciones del Panel
- **Estado del Sistema**: Verificar compatibilidad de audio, vibraci√≥n y push notifications
- **Configuraci√≥n General**: Activar/desactivar sonidos, ajustar volumen, habilitar vibraci√≥n
- **Pruebas Individuales**: Probar cada tipo de sonido por separado
- **Notificaciones Completas**: Probar el sistema completo con sonido + vibraci√≥n + push
- **Informaci√≥n T√©cnica**: Diagnosticos de compatibilidad y configuraci√≥n actual

## üîß Resoluci√≥n de Problemas

### No se escuchan los sonidos

#### En Computadora:
1. **Verificar permisos**:
   - Clic en el candado (üîí) en la barra de URL
   - Cambiar "Notificaciones" a "Permitir"
   - Recargar la p√°gina

2. **Verificar audio del sistema**:
   - Aumentar volumen del sistema
   - Verificar que no est√© silenciado
   - Probar con otros sonidos del navegador

3. **AudioContext suspendido**:
   - Hacer clic en cualquier parte de la p√°gina
   - El AudioContext se activa autom√°ticamente

#### En M√≥vil:
1. **Permisos de notificaci√≥n**:
   - Ir a Configuraci√≥n > Sitios web > Notificaciones
   - Permitir notificaciones para el sitio
   - Activar sonidos de notificaci√≥n

2. **Vibraci√≥n no funciona**:
   - Verificar que no est√© en modo silencioso
   - Activar vibraci√≥n en configuraciones de accesibilidad

3. **Pantalla apagada**:
   - Asegurarse de que las notificaciones push est√©n permitidas
   - Verificar que la app no est√© en lista de sitios bloqueados

### Los sonidos se cortan o no se repiten

1. **Limpiar cach√© del navegador**
2. **Recargar la p√°gina completamente** (Ctrl+F5)
3. **Verificar que no hay otros tabs con audio activo**
4. **En m√≥vil**: Cerrar otras aplicaciones que usen audio

### Notificaciones no aparecen en segundo plano

1. **Verificar Service Worker**:
   ```javascript
   // Ejecutar en consola
   navigator.serviceWorker.getRegistrations().then(registrations => {
     console.log('Service Workers:', registrations.length);
   });
   ```

2. **Re-registrar Service Worker**:
   ```javascript
   window.activateAdvancedNotifications();
   ```

3. **Verificar permisos del navegador**:
   - Chrome: Configuraci√≥n > Privacidad y seguridad > Configuraci√≥n de sitio > Notificaciones
   - Firefox: about:preferences#privacy > Permisos > Notificaciones

## üìä Monitoreo y Logs

### Logs de Consola
El sistema genera logs detallados para facilitar el diagn√≥stico:

```
üöÄ Iniciando sistema avanzado de notificaciones...
‚úÖ PERMISOS CONCEDIDOS - Notificaciones habilitadas
üîä AudioContext creado: running
‚úÖ Service Worker registrado
‚úÖ SISTEMA AVANZADO DE NOTIFICACIONES ACTIVADO
```

### Verificaci√≥n del Estado
```javascript
// Verificar estado actual
console.log('Audio Context:', window.AudioContext ? 'Soportado' : 'No soportado');
console.log('Notificaciones:', Notification.permission);
console.log('Vibraci√≥n:', 'vibrate' in navigator ? 'Soportado' : 'No soportado');
```

## üéØ Mejores Pr√°cticas

### Para Usuarios
1. **Permitir notificaciones** al visitar la aplicaci√≥n por primera vez
2. **Mantener volumen alto** para escuchar notificaciones importantes
3. **Activar vibraci√≥n** en dispositivos m√≥viles para mejor experiencia
4. **Probar sonidos regularmente** usando el panel de configuraci√≥n

### Para Desarrolladores
1. **Siempre verificar compatibilidad** antes de usar funciones de audio
2. **Manejar errores graciosamente** cuando AudioContext no est√° disponible
3. **Usar repeticiones** solo para notificaciones cr√≠ticas
4. **Respetar configuraci√≥n del usuario** (volumen, vibraci√≥n habilitada)

### Para la Comunidad
1. **Educar usuarios** sobre permisos de notificaci√≥n
2. **Promover uso responsable** de notificaciones cr√≠ticas
3. **Reportar problemas** espec√≠ficos del dispositivo/navegador usado
4. **Mantener actualizados** los navegadores para mejor compatibilidad

## üì± Compatibilidad

### Navegadores Soportados
- ‚úÖ **Chrome** 66+ (Completo)
- ‚úÖ **Firefox** 60+ (Completo)
- ‚úÖ **Safari** 14+ (Sin vibraci√≥n)
- ‚úÖ **Edge** 79+ (Completo)
- ‚ö†Ô∏è **Internet Explorer** (No soportado)

### Dispositivos
- ‚úÖ **Android** 5.0+ (Completo)
- ‚úÖ **iOS** 14+ (Sin vibraci√≥n personalizada)
- ‚úÖ **Windows** 10+ (Completo)
- ‚úÖ **macOS** (Completo)
- ‚úÖ **Linux** (Completo)

### Limitaciones Conocidas
- **iOS Safari**: Vibraci√≥n limitada a patrones predefinidos
- **Modo Inc√≥gnito**: Service Workers pueden estar deshabilitados
- **Navegadores antiguos**: Fallback a alertas del sistema

## üîÑ Actualizaciones Futuras

### Versi√≥n 1.1 (Planeada)
- [ ] Sonidos personalizados por usuario
- [ ] Integraci√≥n con notificaciones push del servidor
- [ ] Configuraci√≥n de horarios de silencio
- [ ] Sonidos especiales para eventos de temporada

### Versi√≥n 1.2 (Planeada)  
- [ ] Soporte para Web Push API
- [ ] Notificaciones geogr√°ficas para repartidores
- [ ] Anal√≠ticas de efectividad de notificaciones
- [ ] Configuraci√≥n de prioridades por usuario

---

## üìû Soporte

Para problemas t√©cnicos o sugerencias:

1. **Revisar logs en consola** del navegador (F12)
2. **Probar en navegador diferente** para descartar problemas de compatibilidad
3. **Verificar permisos** de notificaciones y audio
4. **Reportar dispositivo/navegador espec√≠fico** si el problema persiste

**Recuerda**: Este sistema est√° dise√±ado para mantener a la comunidad conectada y informada. ¬°El sonido de una notificaci√≥n puede significar una nueva oportunidad de negocio! üöÄ
