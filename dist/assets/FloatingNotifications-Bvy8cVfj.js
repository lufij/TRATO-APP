import{g as f,r as d,j as e,p as g,X as h}from"./index-BTyKdRD7.js";import{V as b}from"./volume-2-BMej0IbQ.js";import{T as j}from"./triangle-alert-O3EMxmTl.js";import{S as v}from"./shopping-bag-CcHcjL33.js";import{C as w}from"./clock-DJp80oyB.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],T=f("smartphone",S);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],k=f("volume-x",C);function V(){const[i,s]=d.useState({notifications:"default",audio:!1,persistent:!1}),[a,r]=d.useState(!1),[p,n]=d.useState(!1);d.useEffect(()=>{l(),localStorage.getItem("trato_permissions")&&s(o=>({...o,persistent:!0}))},[]);const l=()=>{const t={notifications:Notification.permission,audio:!0,persistent:localStorage.getItem("trato_permissions")==="granted"};s(t)},c=async()=>{try{if(console.log("📱 Solicitando permisos de notificación..."),await Notification.requestPermission()==="granted"){localStorage.setItem("trato_permissions","granted"),localStorage.setItem("trato_permissions_date",new Date().toISOString());const o=new Notification("🎉 ¡Permisos Activados!",{body:"Las notificaciones de TRATO están activas",icon:"/favicon.ico",tag:"permission-granted",requireInteraction:!0});setTimeout(()=>o.close(),3e3),console.log("✅ Permisos concedidos y guardados")}l()}catch(t){console.error("❌ Error al solicitar permisos:",t),r(!0)}},u=async()=>{n(!0);try{const t=new(window.AudioContext||window.webkitAudioContext),o=t.createOscillator(),x=t.createGain();o.connect(x),x.connect(t.destination),o.frequency.setValueAtTime(800,t.currentTime),o.frequency.exponentialRampToValueAtTime(600,t.currentTime+.3),o.type="sine",x.gain.setValueAtTime(0,t.currentTime),x.gain.linearRampToValueAtTime(.3,t.currentTime+.1),x.gain.exponentialRampToValueAtTime(.01,t.currentTime+.8),o.start(t.currentTime),o.stop(t.currentTime+.8),console.log("🔊 Sonido de prueba reproducido"),setTimeout(()=>{n(!1),s(y=>({...y,audio:!0}))},1e3)}catch(t){console.error("❌ Error con audio:",t),n(!1),s(o=>({...o,audio:!1}))}};return i.notifications!=="granted"||!i.persistent?e.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e3,backgroundColor:"#ff6b35",color:"white",padding:"15px",borderRadius:"10px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",maxWidth:"300px",fontFamily:"system-ui, sans-serif"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(g,{size:24}),e.jsx("strong",{children:"Activar Notificaciones"})]}),e.jsx("p",{style:{margin:"0 0 15px 0",fontSize:"14px",lineHeight:"1.4"},children:"Para recibir alertas de nuevos pedidos con sonido"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[i.notifications!=="granted"&&e.jsxs("button",{onClick:c,style:{backgroundColor:"white",color:"#ff6b35",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx(g,{size:16}),"Permitir Notificaciones"]}),e.jsxs("button",{onClick:u,disabled:p,style:{backgroundColor:i.audio?"#28a745":"rgba(255,255,255,0.2)",color:"white",border:"1px solid rgba(255,255,255,0.3)",padding:"8px 12px",borderRadius:"5px",cursor:p?"not-allowed":"pointer",fontSize:"13px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[p?e.jsx(k,{size:14}):e.jsx(b,{size:14}),p?"Probando...":"Probar Sonido"]})]}),a&&e.jsxs("div",{style:{marginTop:"15px",padding:"10px",backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"5px",fontSize:"12px",lineHeight:"1.3"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",marginBottom:"5px"},children:[e.jsx(T,{size:14}),e.jsx("strong",{children:"Instrucciones Mobile:"})]}),e.jsxs("ul",{style:{margin:"0",paddingLeft:"15px"},children:[e.jsx("li",{children:"Android: Configuración → Apps → Chrome → Notificaciones"}),e.jsx("li",{children:"iPhone: Configuración → Safari → Notificaciones"}),e.jsx("li",{children:"Permitir sonidos y ventanas emergentes"})]}),e.jsx("button",{onClick:()=>r(!1),style:{marginTop:"8px",backgroundColor:"transparent",color:"white",border:"1px solid rgba(255,255,255,0.3)",padding:"5px 10px",borderRadius:"3px",cursor:"pointer",fontSize:"11px"},children:"Cerrar"})]}),e.jsxs("div",{style:{marginTop:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:"11px",opacity:.8},children:["Estado: ",i.notifications," | Audio: ",i.audio?"✓":"✗"]}),e.jsx("button",{onClick:()=>r(!a),style:{backgroundColor:"transparent",color:"white",border:"none",cursor:"pointer",padding:"5px"},children:e.jsx(j,{size:14})})]})]}):null}function B({notifications:i,onRemove:s}){return e.jsx("div",{style:{position:"fixed",top:"80px",right:"20px",zIndex:2e3,display:"flex",flexDirection:"column",gap:"10px",maxWidth:"400px"},children:i.map((a,r)=>e.jsx(I,{notification:a,onRemove:s,index:r},a.id))})}function I({notification:i,onRemove:s,index:a}){var m;const[r,p]=d.useState(!1),[n,l]=d.useState(!1);d.useEffect(()=>{const t=setTimeout(()=>p(!0),100+a*100),o=i.duration||5e3,x=setTimeout(()=>{c()},o);return()=>{clearTimeout(t),clearTimeout(x)}},[i,a]);const c=()=>{l(!0),setTimeout(()=>{s(i.id)},300)},u=t=>new Date(t).toLocaleTimeString("es-GT",{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #e0e0e0",borderRadius:"12px",padding:"16px",boxShadow:r?"0 8px 25px rgba(0,0,0,0.15)":"0 4px 12px rgba(0,0,0,0.05)",transform:r&&!n?"translateX(0) scale(1)":n?"translateX(100%) scale(0.9)":"translateX(100%) scale(0.95)",opacity:r&&!n?1:0,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",borderLeft:"4px solid #28a745",position:"relative",cursor:"pointer"},onClick:c,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{backgroundColor:"#28a745",borderRadius:"50%",padding:"6px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(v,{size:14,color:"white"})}),e.jsx("strong",{style:{color:"#2d3748",fontSize:"15px",fontWeight:"600"},children:i.title})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),c()},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"4px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.2s"},onMouseEnter:t=>t.target.style.opacity="1",onMouseLeave:t=>t.target.style.opacity="0.6",children:e.jsx(h,{size:16,color:"#666"})})]}),e.jsx("p",{style:{margin:"0 0 8px 0",color:"#4a5568",fontSize:"14px",lineHeight:"1.4"},children:i.message}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"12px",color:"#718096"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(w,{size:12}),u(i.timestamp)]}),i.orderData&&e.jsxs("div",{style:{backgroundColor:"#f7fafc",padding:"2px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"500",color:"#2d3748"},children:["ID: #",((m=i.orderData.id)==null?void 0:m.toString().slice(-4))||"N/A"]})]}),e.jsx("div",{style:{position:"absolute",bottom:"0",left:"0",height:"2px",backgroundColor:"#28a745",borderBottomLeftRadius:"12px",borderBottomRightRadius:"12px",animation:`progressBar ${i.duration||5e3}ms linear forwards`,width:"0%"}}),e.jsx("style",{children:`
          @keyframes progressBar {
            from { width: 100%; }
            to { width: 0%; }
          }
        `})]})}function D(){const[i,s]=d.useState([]);return{notifications:i,addNotification:n=>{const l={...n,id:`notif-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()};return s(c=>[l,...c.slice(0,4)]),l.id},removeNotification:n=>{s(l=>l.filter(c=>c.id!==n))},clearAll:()=>{s([])}}}export{B as F,V as N,D as u};
