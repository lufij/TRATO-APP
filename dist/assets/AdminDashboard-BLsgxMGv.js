import{g as ke,j as e,o as M,r as x,C as _,c as E,B as g,a as R,b as D,f as L,P as se,s as v,t as m,v as ae,p as Re,u as De,e as ne,R as B,T as ce,E as Y}from"./index-Dv1WvEuL.js";import{I as V}from"./input-CCkj6W48.js";import{D as de,c as xe,N as Le,T as Oe,a as Pe,b as q,P as re,d as I}from"./NotificationSystem-k5q_h9xV.js";import{S as O,a as P,b as z,c as U,d as n}from"./select-BaxLBPBc.js";import{A as he,a as me,b as ue,c as je,d as ge,e as ve,f as pe,g as fe,h as be}from"./alert-dialog-B4eEmjEn.js";import{T as ze,a as G}from"./colors-BLlkNVHy.js";import{T as X}from"./triangle-alert-DImANo_y.js";import{U as J}from"./users-BLNp4JYK.js";import{T as Ne}from"./truck-BDV9YroT.js";import{S as K}from"./shopping-cart-CRgqsP9k.js";import{A as ye}from"./activity-DBQ2vtns.js";import{C as Ue}from"./circle-x-dA6F_1HG.js";import{C as Fe}from"./clock-uTFIZ_9a.js";import{M as Ve,S as Z}from"./search-D7HOj11y.js";import{S as W}from"./store-BwWbzZRG.js";import{S as we}from"./shield-BE4qBsPY.js";import{C as oe}from"./crown-B8_coAiH.js";import{T as Ce}from"./trash-2-OVKram7e.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],Ie=ke("trending-down",qe);function te({className:r,...h}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:M("w-full caption-bottom text-sm",r),...h})})}function le({className:r,...h}){return e.jsx("thead",{"data-slot":"table-header",className:M("[&_tr]:border-b",r),...h})}function ie({className:r,...h}){return e.jsx("tbody",{"data-slot":"table-body",className:M("[&_tr:last-child]:border-0",r),...h})}function $({className:r,...h}){return e.jsx("tr",{"data-slot":"table-row",className:M("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",r),...h})}function C({className:r,...h}){return e.jsx("th",{"data-slot":"table-head",className:M("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...h})}function S({className:r,...h}){return e.jsx("td",{"data-slot":"table-cell",className:M("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...h})}function Be(){const[r,h]=x.useState(null),[o,p]=x.useState(!0),[u,w]=x.useState(new Date),[c,A]=x.useState(!0),f=async()=>{try{const{data:s,error:a}=await v.rpc("get_admin_stats");if(a){console.error("Error fetching admin stats:",a),m.error("Error al cargar estadísticas");return}h(s),w(new Date)}catch(s){console.error("Error fetching stats:",s),m.error("Error de conexión")}finally{p(!1)}};x.useEffect(()=>{f()},[]),x.useEffect(()=>{if(!c)return;const s=setInterval(()=>{f()},3e4);return()=>clearInterval(s)},[c]);const k=(s,a="number")=>{switch(a){case"currency":return`Q${s.toFixed(2)}`;case"percentage":return`${s.toFixed(1)}%`;default:return s.toString()}},l=(s,a)=>s>a?e.jsx(xe,{className:"w-4 h-4 text-green-500"}):s<a?e.jsx(Ie,{className:"w-4 h-4 text-red-500"}):e.jsx(Ve,{className:"w-4 h-4 text-gray-500"}),t=()=>{if(!r)return{status:"checking",color:"yellow",label:"Verificando..."};const s=r.pending_drivers>5||!r.active_drivers,a=r.pending_businesses>0||r.pending_drivers>0;return s?{status:"critical",color:"red",label:"Requiere Atención"}:a?{status:"warning",color:"yellow",label:"Advertencias"}:{status:"healthy",color:"green",label:"Sistema Saludable"}};if(o)return e.jsx(_,{children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"}),e.jsx("span",{className:"ml-2",children:"Cargando estadísticas..."})]})})});if(!r)return e.jsx(_,{children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"text-center text-red-600",children:[e.jsx(X,{className:"w-12 h-12 mx-auto mb-4"}),e.jsx("p",{children:"Error al cargar estadísticas del sistema"}),e.jsx(g,{onClick:f,className:"mt-4",children:"Reintentar"})]})})});const d=t(),b=[{label:"Usuarios Activos",value:r.active_users,previousValue:r.total_users,icon:J,color:"blue"},{label:"Repartidores Activos",value:r.active_drivers,previousValue:r.total_drivers,icon:Ne,color:"orange"},{label:"Órdenes Hoy",value:r.orders_today,previousValue:0,icon:K,color:"purple"},{label:"Ingresos Hoy",value:r.revenue_today,previousValue:0,icon:de,color:"green",format:"currency"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{className:`border-l-4 ${d.color==="red"?"border-l-red-500 bg-red-50":d.color==="yellow"?"border-l-yellow-500 bg-yellow-50":"border-l-green-500 bg-green-50"}`,children:[e.jsx(R,{children:e.jsxs(D,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:`w-5 h-5 ${d.color==="red"?"text-red-600":d.color==="yellow"?"text-yellow-600":"text-green-600"}`}),e.jsx("span",{children:"Estado del Sistema TRATO"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{variant:d.status==="healthy"?"default":"destructive",className:`${d.color==="green"?"bg-green-100 text-green-800":d.color==="yellow"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:d.label}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>A(!c),className:c?"bg-green-50 border-green-300":"",children:c?"Auto-refresh ON":"Auto-refresh OFF"})]})]})}),e.jsxs(E,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:b.map((s,a)=>e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(s.icon,{className:`w-5 h-5 text-${s.color}-600`}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.label})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:k(s.value,s.format)}),e.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[l(s.value,s.previousValue),e.jsxs("span",{className:"text-xs text-gray-500",children:["vs ",k(s.previousValue,s.format)]})]})]},a))}),e.jsxs("div",{className:"mt-6 space-y-2",children:[r.pending_drivers>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4 text-orange-500"}),e.jsxs("span",{className:"text-sm font-medium text-orange-800",children:[r.pending_drivers," repartidor",r.pending_drivers>1?"es":""," pendiente",r.pending_drivers>1?"s":""," de aprobación"]})]}),e.jsx(g,{size:"sm",className:"bg-orange-500 hover:bg-orange-600",children:"Revisar"})]}),r.pending_businesses>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm font-medium text-blue-800",children:[r.pending_businesses," negocio",r.pending_businesses>1?"s":""," pendiente",r.pending_businesses>1?"s":""," de verificación"]})]}),e.jsx(g,{size:"sm",variant:"outline",className:"border-blue-300 text-blue-700",children:"Revisar"})]}),r.active_drivers===0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-red-800",children:"¡No hay repartidores activos! Las entregas están pausadas."})]}),e.jsx(g,{size:"sm",variant:"destructive",children:"Activar Repartidores"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Última actualización: ",u.toLocaleTimeString()]})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:f,className:"text-gray-600 hover:text-gray-900",children:"Actualizar ahora"})]})]})]}),e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Salud del Sistema"})}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Repartidores Activos"}),e.jsxs("span",{children:[r.active_drivers,"/",r.total_drivers]})]}),e.jsx(se,{value:r.total_drivers>0?r.active_drivers/r.total_drivers*100:0,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Negocios Verificados"}),e.jsxs("span",{children:[r.total_businesses,"/",r.total_businesses+r.pending_businesses]})]}),e.jsx(se,{value:r.total_businesses+r.pending_businesses>0?r.total_businesses/(r.total_businesses+r.pending_businesses)*100:0,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Usuarios Activos"}),e.jsxs("span",{children:[r.active_users,"/",r.total_users]})]}),e.jsx(se,{value:r.total_users>0?r.active_users/r.total_users*100:0,className:"h-2"})]})]})})]})]})}function $e(){const[r,h]=x.useState("general"),[o,p]=x.useState({appName:"TRATO",maintenanceMode:!1,allowRegistrations:!0,deliveryFee:10,platformCommission:5}),u=[{id:"general",name:"General",icon:ae},{id:"delivery",name:"Entrega",icon:W},{id:"users",name:"Usuarios",icon:J},{id:"notifications",name:"Notificaciones",icon:Re},{id:"security",name:"Seguridad",icon:we}],w=()=>{m.success("Configuración guardada correctamente")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Configuración del Sistema"}),e.jsx("p",{className:"text-muted-foreground",children:"Administra todos los aspectos de tu plataforma desde aquí."})]}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:u.map(c=>{const A=c.icon;return e.jsxs("button",{onClick:()=>h(c.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${r===c.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-gray-300"}`,children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:c.name})]},c.id)})})}),e.jsxs("div",{className:"space-y-6",children:[r==="general"&&e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Configuración General"})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nombre de la Aplicación"}),e.jsx(V,{value:o.appName,onChange:c=>p({...o,appName:c.target.value})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"maintenance",checked:o.maintenanceMode,onChange:c=>p({...o,maintenanceMode:c.target.checked})}),e.jsx("label",{htmlFor:"maintenance",className:"text-sm font-medium",children:"Modo Mantenimiento"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"registrations",checked:o.allowRegistrations,onChange:c=>p({...o,allowRegistrations:c.target.checked})}),e.jsx("label",{htmlFor:"registrations",className:"text-sm font-medium",children:"Permitir Nuevos Registros"})]})]})]}),r==="delivery"&&e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Configuración de Entrega"})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tarifa de Entrega (Bs)"}),e.jsx(V,{type:"number",value:o.deliveryFee,onChange:c=>p({...o,deliveryFee:parseInt(c.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Comisión de Plataforma (%)"}),e.jsx(V,{type:"number",value:o.platformCommission,onChange:c=>p({...o,platformCommission:parseInt(c.target.value)})})]})]})]}),r==="users"&&e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Gestión de Usuarios"})}),e.jsx(E,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"25"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Compradores"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"8"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Vendedores"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"5"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Repartidores"})]})]})})})]}),r==="notifications"&&e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Configuración de Notificaciones"})}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configurar las preferencias de notificación del sistema."}),e.jsx(L,{variant:"outline",children:"Próximamente"})]})})]}),r==="security"&&e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Configuración de Seguridad"})}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configurar las políticas de seguridad del sistema."}),e.jsx(L,{variant:"outline",children:"Próximamente"})]})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(g,{variant:"outline",children:"Cancelar"}),e.jsx(g,{onClick:w,children:"Guardar Cambios"})]})]})}function H({title:r,value:h,icon:o,trend:p,color:u,subtitle:w}){return e.jsx(_,{className:"bg-white/80 backdrop-blur-sm border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:e.jsxs(E,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:r}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:h}),w&&e.jsx("p",{className:"text-xs text-gray-500",children:w})]}),e.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center",style:{backgroundColor:u},children:e.jsx(o,{className:"w-8 h-8 text-white"})})]}),p&&e.jsxs("div",{className:"mt-4 flex items-center",children:[e.jsx(xe,{className:"w-4 h-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-sm text-green-600 font-medium",children:p})]})]})})}function Me(){const[r,h]=x.useState([]),[o,p]=x.useState(!0),[u,w]=x.useState(""),[c,A]=x.useState("all"),[f,k]=x.useState("all"),l=async()=>{try{p(!0);const{data:s,error:a}=await v.from("users").select(`
          id,
          email,
          name,
          role,
          phone,
          avatar_url,
          is_active,
          is_verified,
          profile_completed,
          created_at,
          updated_at
        `).order("created_at",{ascending:!1});if(a)throw a;h(s||[])}catch(s){console.error("Error fetching users:",s),m.error("Error al cargar usuarios")}finally{p(!1)}};x.useEffect(()=>{l()},[]);const t=r.filter(s=>{var N,y;const a=((N=s.name)==null?void 0:N.toLowerCase().includes(u.toLowerCase()))||s.email.toLowerCase().includes(u.toLowerCase())||((y=s.phone)==null?void 0:y.toLowerCase().includes(u.toLowerCase())),i=c==="all"||s.role===c,j=f==="all"||(s.is_active!==void 0?s.is_active?"active":"inactive":"active")===f;return a&&i&&j}),d=async(s,a)=>{try{const{error:i}=await v.from("users").update({is_active:a==="active"}).eq("id",s);if(i)throw i;m.success("Estado de usuario actualizado"),l()}catch(i){console.error("Error updating user status:",i),m.error("Error al actualizar estado")}},b=async s=>{try{const{error:a}=await v.from("users").delete().eq("id",s);if(a)throw a;m.success("Usuario eliminado"),l()}catch(a){console.error("Error deleting user:",a),m.error("No se pudo eliminar. Revisa relaciones o prueba suspenderlo.")}};return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Gestión de Usuarios"})}),e.jsxs(E,{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(V,{placeholder:"Buscar usuarios...",value:u,onChange:s=>w(s.target.value),className:"pl-10"})]})}),e.jsxs(O,{value:c,onValueChange:A,children:[e.jsx(P,{className:"w-[180px]",children:e.jsx(z,{placeholder:"Filtrar por rol"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"Todos los roles"}),e.jsx(n,{value:"comprador",children:"Compradores"}),e.jsx(n,{value:"vendedor",children:"Vendedores"}),e.jsx(n,{value:"repartidor",children:"Repartidores"})]})]}),e.jsxs(O,{value:f,onValueChange:s=>k(s),children:[e.jsx(P,{className:"w-[180px]",children:e.jsx(z,{placeholder:"Filtrar por estado"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"Todos los estados"}),e.jsx(n,{value:"active",children:"Activos"}),e.jsx(n,{value:"inactive",children:"Inactivos"}),e.jsx(n,{value:"suspended",children:"Suspendidos"})]})]}),e.jsxs(g,{onClick:l,variant:"outline",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Actualizar"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(te,{children:[e.jsx(le,{children:e.jsxs($,{children:[e.jsx(C,{children:"Usuario"}),e.jsx(C,{children:"Rol"}),e.jsx(C,{children:"Estado"}),e.jsx(C,{children:"Registro"}),e.jsx(C,{children:"Acciones"})]})}),e.jsx(ie,{children:t.map(s=>e.jsxs($,{children:[e.jsx(S,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name||"Sin nombre"}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email}),s.phone&&e.jsx("div",{className:"text-sm text-gray-500",children:s.phone})]})}),e.jsx(S,{children:e.jsx(L,{variant:s.role==="vendedor"?"default":"secondary",className:`${s.role==="comprador"?"bg-orange-100 text-orange-800":s.role==="vendedor"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:s.role})}),e.jsx(S,{children:e.jsx(L,{variant:(s.is_active!==void 0?s.is_active?"active":"inactive":"active")=="active"?"default":"destructive",className:`${(s.is_active!==void 0?s.is_active?"active":"inactive":"active")=="active"?"bg-green-100 text-green-800":(s.is_active!==void 0?s.is_active?"active":"inactive":"active")=="inactive"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:s.is_active!==void 0?s.is_active?"active":"inactive":"active"})}),e.jsx(S,{children:e.jsx("div",{className:"text-sm",children:new Date(s.created_at).toLocaleDateString()})}),e.jsx(S,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsxs(O,{value:s.is_active!==void 0?s.is_active?"active":"inactive":"active",onValueChange:a=>d(s.id,a),children:[e.jsx(P,{className:"w-24 h-8",children:e.jsx(z,{})}),e.jsxs(U,{children:[e.jsx(n,{value:"active",children:"Activo"}),e.jsx(n,{value:"inactive",children:"Inactivo"}),e.jsx(n,{value:"suspended",children:"Suspendido"})]})]}),e.jsxs(he,{children:[e.jsx(me,{asChild:!0,children:e.jsxs(g,{variant:"outline",size:"sm",title:"Eliminar usuario",className:"text-red-600 border-red-300 hover:text-red-700 hover:bg-red-50",children:[e.jsx(Ce,{className:"w-4 h-4 mr-1"}),"Eliminar"]})}),e.jsxs(ue,{children:[e.jsxs(je,{children:[e.jsx(ge,{children:"¿Eliminar usuario?"}),e.jsx(ve,{children:'Esta acción no se puede deshacer y puede fallar si el usuario tiene datos relacionados. Si falla, puedes cambiar su estado a "Suspendido".'})]}),e.jsxs(pe,{children:[e.jsx(fe,{children:"Cancelar"}),e.jsx(be,{className:"bg-red-600 hover:bg-red-700",onClick:()=>b(s.id),children:"Eliminar"})]})]})]})]})})]},s.id))})]})}),t.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No se encontraron usuarios que coincidan con los filtros"})]})]})})}function Ge(){const[r,h]=x.useState([]),[o,p]=x.useState(!0),[u,w]=x.useState(""),[c,A]=x.useState("all"),f=async()=>{try{p(!0);const{data:t,error:d}=await v.from("sellers").select(`
          *,
          users (
            name,
            email,
            phone,
            created_at
          )
        `).order("created_at",{ascending:!1});d?(console.error("Error fetching businesses:",d),m.error("Error al cargar negocios"),h([])):h(t||[])}catch(t){console.error("Error fetching businesses:",t),m.error("Error al cargar negocios"),h([])}finally{p(!1)}};x.useEffect(()=>{f()},[]);const k=async(t,d)=>{try{const{error:b}=await v.from("sellers").update({is_verified:d}).eq("id",t);if(b)throw b;m.success("Estado del negocio actualizado"),f()}catch(b){console.error("Error updating business status:",b),m.error("Error al actualizar estado")}},l=r.filter(t=>{var s,a,i,j,N;const d=((s=t.business_name)==null?void 0:s.toLowerCase().includes(u.toLowerCase()))||((i=(a=t.users)==null?void 0:a.name)==null?void 0:i.toLowerCase().includes(u.toLowerCase()))||((N=(j=t.users)==null?void 0:j.email)==null?void 0:N.toLowerCase().includes(u.toLowerCase())),b=c==="all"||c==="verified"&&t.is_verified||c==="pending"&&!t.is_verified;return d&&b});return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Gestión de Negocios"})}),e.jsxs(E,{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(V,{placeholder:"Buscar negocios...",value:u,onChange:t=>w(t.target.value),className:"pl-10"})]})}),e.jsxs(O,{value:c,onValueChange:A,children:[e.jsx(P,{className:"w-[180px]",children:e.jsx(z,{placeholder:"Filtrar por estado"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"Todos los estados"}),e.jsx(n,{value:"verified",children:"Verificados"}),e.jsx(n,{value:"pending",children:"Pendientes"})]})]}),e.jsxs(g,{onClick:f,variant:"outline",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Actualizar"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(te,{children:[e.jsx(le,{children:e.jsxs($,{children:[e.jsx(C,{children:"Negocio"}),e.jsx(C,{children:"Propietario"}),e.jsx(C,{children:"Estado"}),e.jsx(C,{children:"Registro"}),e.jsx(C,{children:"Acciones"})]})}),e.jsx(ie,{children:l.map(t=>{var d,b,s;return e.jsxs($,{children:[e.jsx(S,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.business_name||"Sin nombre"}),e.jsx("div",{className:"text-sm text-gray-500",children:t.business_description||"Sin descripción"}),t.business_category&&e.jsx(L,{variant:"outline",className:"text-xs mt-1",children:t.business_category})]})}),e.jsx(S,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((d=t.users)==null?void 0:d.name)||"Sin nombre"}),e.jsx("div",{className:"text-sm text-gray-500",children:(b=t.users)==null?void 0:b.email}),((s=t.users)==null?void 0:s.phone)&&e.jsx("div",{className:"text-sm text-gray-500",children:t.users.phone})]})}),e.jsx(S,{children:e.jsx(L,{variant:t.is_verified?"default":"destructive",className:`${t.is_verified?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.is_verified?"Verificado":"Pendiente"})}),e.jsx(S,{children:e.jsx("div",{className:"text-sm",children:new Date(t.created_at).toLocaleDateString()})}),e.jsx(S,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(g,{variant:t.is_verified?"destructive":"default",size:"sm",onClick:()=>k(t.id,!t.is_verified),children:t.is_verified?"Desverificar":"Verificar"})]})})]},t.id)})})]})}),l.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:r.length===0?e.jsxs("div",{children:[e.jsx(W,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No hay negocios registrados aún"})]}):e.jsx("p",{children:"No se encontraron negocios que coincidan con los filtros"})})]})]})})}function He(){const[r,h]=x.useState([]),[o,p]=x.useState(!0),[u,w]=x.useState(""),[c,A]=x.useState("all"),[f,k]=x.useState("today"),l=async()=>{try{p(!0);const s=new Date;let a="";switch(f){case"today":a=s.toISOString().split("T")[0];break;case"week":a=new Date(s.getTime()-7*24*60*60*1e3).toISOString().split("T")[0];break;case"month":a=new Date(s.getTime()-30*24*60*60*1e3).toISOString().split("T")[0];break}let i=v.from("orders").select(`
          *,
          buyer:users!buyer_id (name, email),
          seller:sellers!seller_id (business_name),
          driver:users!driver_id (name, email)
        `).order("created_at",{ascending:!1});f!=="all"&&(i=i.gte("created_at",a));const{data:j,error:N}=await i;N?(console.error("Error fetching orders:",N),h([])):h(j||[])}catch(s){console.error("Error fetching orders:",s),h([])}finally{p(!1)}};x.useEffect(()=>{l()},[f]);const t=async(s,a)=>{try{const{error:i}=await v.from("orders").update({status:a,updated_at:new Date().toISOString()}).eq("id",s);if(i)throw i;m.success("Estado de la orden actualizado"),l()}catch(i){console.error("Error updating order status:",i),m.error("Error al actualizar estado")}},d=s=>{const i={pending:{label:"Pendiente",class:"bg-yellow-100 text-yellow-800"},confirmed:{label:"Confirmado",class:"bg-blue-100 text-blue-800"},preparing:{label:"Preparando",class:"bg-orange-100 text-orange-800"},ready:{label:"Listo",class:"bg-purple-100 text-purple-800"},picked_up:{label:"Recogido",class:"bg-indigo-100 text-indigo-800"},delivered:{label:"Entregado",class:"bg-green-100 text-green-800"},cancelled:{label:"Cancelado",class:"bg-red-100 text-red-800"}}[s]||{label:s,class:"bg-gray-100 text-gray-800"};return e.jsx(L,{className:i.class,children:i.label})},b=r.filter(s=>{var j,N,y,T,F;const a=((j=s.id)==null?void 0:j.toLowerCase().includes(u.toLowerCase()))||((y=(N=s.buyer)==null?void 0:N.name)==null?void 0:y.toLowerCase().includes(u.toLowerCase()))||((F=(T=s.seller)==null?void 0:T.name)==null?void 0:F.toLowerCase().includes(u.toLowerCase())),i=c==="all"||s.status===c;return a&&i});return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Gestión de Órdenes"})}),e.jsxs(E,{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(V,{placeholder:"Buscar órdenes...",value:u,onChange:s=>w(s.target.value),className:"pl-10"})]})}),e.jsxs(O,{value:c,onValueChange:s=>A(s),children:[e.jsx(P,{className:"w-[150px]",children:e.jsx(z,{placeholder:"Estado"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"Todos"}),e.jsx(n,{value:"pending",children:"Pendiente"}),e.jsx(n,{value:"confirmed",children:"Confirmado"}),e.jsx(n,{value:"preparing",children:"Preparando"}),e.jsx(n,{value:"ready",children:"Listo"}),e.jsx(n,{value:"picked_up",children:"Recogido"}),e.jsx(n,{value:"delivered",children:"Entregado"}),e.jsx(n,{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs(O,{value:f,onValueChange:s=>k(s),children:[e.jsx(P,{className:"w-[150px]",children:e.jsx(z,{placeholder:"Período"})}),e.jsxs(U,{children:[e.jsx(n,{value:"today",children:"Hoy"}),e.jsx(n,{value:"week",children:"Esta semana"}),e.jsx(n,{value:"month",children:"Este mes"}),e.jsx(n,{value:"all",children:"Todo"})]})]}),e.jsxs(g,{onClick:l,variant:"outline",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Actualizar"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(te,{children:[e.jsx(le,{children:e.jsxs($,{children:[e.jsx(C,{children:"Orden"}),e.jsx(C,{children:"Comprador"}),e.jsx(C,{children:"Vendedor"}),e.jsx(C,{children:"Total"}),e.jsx(C,{children:"Estado"}),e.jsx(C,{children:"Fecha"}),e.jsx(C,{children:"Acciones"})]})}),e.jsx(ie,{children:b.map(s=>{var a,i,j,N,y;return e.jsxs($,{children:[e.jsx(S,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["#",s.id.slice(0,8)]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.delivery_type})]})}),e.jsx(S,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((a=s.buyer)==null?void 0:a.name)||"Usuario"}),e.jsx("div",{className:"text-sm text-gray-500",children:(i=s.buyer)==null?void 0:i.email})]})}),e.jsx(S,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((j=s.seller)==null?void 0:j.name)||"Vendedor"}),e.jsx("div",{className:"text-sm text-gray-500",children:(N=s.seller)==null?void 0:N.email})]})}),e.jsx(S,{children:e.jsxs("div",{className:"font-medium",children:["Q",((y=s.total)==null?void 0:y.toFixed(2))||"0.00"]})}),e.jsx(S,{children:d(s.status)}),e.jsx(S,{children:e.jsxs("div",{className:"text-sm",children:[new Date(s.created_at).toLocaleDateString(),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleTimeString()})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsxs(O,{value:s.status,onValueChange:T=>t(s.id,T),children:[e.jsx(P,{className:"w-32 h-8",children:e.jsx(z,{})}),e.jsxs(U,{children:[e.jsx(n,{value:"pending",children:"Pendiente"}),e.jsx(n,{value:"confirmed",children:"Confirmado"}),e.jsx(n,{value:"preparing",children:"Preparando"}),e.jsx(n,{value:"ready",children:"Listo"}),e.jsx(n,{value:"picked_up",children:"Recogido"}),e.jsx(n,{value:"delivered",children:"Entregado"}),e.jsx(n,{value:"cancelled",children:"Cancelado"})]})]})]})})]},s.id)})})]})}),b.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:r.length===0?e.jsxs("div",{children:[e.jsx(K,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No hay órdenes registradas aún"}),e.jsx("p",{className:"text-sm mt-2",children:"Las órdenes aparecerán aquí cuando los usuarios hagan pedidos"})]}):e.jsx("p",{children:"No se encontraron órdenes que coincidan con los filtros"})})]})]})})}function Qe(){const[r,h]=x.useState([]),[o,p]=x.useState(!0),[u,w]=x.useState(""),[c,A]=x.useState("all"),[f,k]=x.useState("all"),l=async()=>{try{p(!0);const{data:a,error:i}=await v.from("products").select(`
          *,
          seller:sellers (
            business_name,
            users (name, email)
          )
        `).order("created_at",{ascending:!1});i?(console.error("Error fetching products:",i),h([])):h(a||[])}catch(a){console.error("Error fetching products:",a),h([])}finally{p(!1)}};x.useEffect(()=>{l()},[]);const t=async(a,i)=>{try{const{error:j}=await v.from("products").update({status:i,updated_at:new Date().toISOString()}).eq("id",a);if(j)throw j;m.success("Estado del producto actualizado"),l()}catch(j){console.error("Error updating product status:",j),m.error("Error al actualizar producto")}},d=async a=>{try{const{error:i}=await v.from("products").delete().eq("id",a);if(i)throw i;m.success("Producto eliminado"),l()}catch(i){console.error("Error deleting product:",i),m.error("Error al eliminar producto")}},b=a=>{const j={active:{label:"Activo",class:"bg-green-100 text-green-800"},inactive:{label:"Inactivo",class:"bg-gray-100 text-gray-800"},pending:{label:"Pendiente",class:"bg-yellow-100 text-yellow-800"},rejected:{label:"Rechazado",class:"bg-red-100 text-red-800"}}[a]||{label:a,class:"bg-gray-100 text-gray-800"};return e.jsx(L,{className:j.class,children:j.label})},s=r.filter(a=>{var y,T,F,Q;const i=((y=a.name)==null?void 0:y.toLowerCase().includes(u.toLowerCase()))||((T=a.description)==null?void 0:T.toLowerCase().includes(u.toLowerCase()))||((Q=(F=a.seller)==null?void 0:F.business_name)==null?void 0:Q.toLowerCase().includes(u.toLowerCase())),j=c==="all"||a.category===c,N=f==="all"||(a.status||"active")===f;return i&&j&&N});return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(_,{children:[e.jsx(R,{children:e.jsx(D,{children:"Gestión de Productos"})}),e.jsxs(E,{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(V,{placeholder:"Buscar productos...",value:u,onChange:a=>w(a.target.value),className:"pl-10"})]})}),e.jsxs(O,{value:c,onValueChange:a=>A(a),children:[e.jsx(P,{className:"w-[150px]",children:e.jsx(z,{placeholder:"Categoría"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"Todas"}),e.jsx(n,{value:"comida",children:"Comida"}),e.jsx(n,{value:"bebidas",children:"Bebidas"}),e.jsx(n,{value:"postres",children:"Postres"}),e.jsx(n,{value:"otros",children:"Otros"})]})]}),e.jsxs(O,{value:f,onValueChange:a=>k(a),children:[e.jsx(P,{className:"w-[150px]",children:e.jsx(z,{placeholder:"Estado"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"Todos"}),e.jsx(n,{value:"active",children:"Activos"}),e.jsx(n,{value:"inactive",children:"Inactivos"}),e.jsx(n,{value:"pending",children:"Pendientes"}),e.jsx(n,{value:"rejected",children:"Rechazados"})]})]}),e.jsxs(g,{onClick:l,variant:"outline",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Actualizar"]})]}),s.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(a=>{var i,j,N,y;return e.jsxs(_,{className:"overflow-hidden",children:[e.jsxs("div",{className:"aspect-video bg-gray-100 relative",children:[a.image_url?e.jsx("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-cover",onError:T=>{T.currentTarget.src="https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400&h=300&fit=crop"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(re,{className:"w-12 h-12 text-gray-400"})}),e.jsx("div",{className:"absolute top-2 right-2",children:b(a.status||"active")})]}),e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-lg font-bold text-orange-600",children:["Q",((i=a.price)==null?void 0:i.toFixed(2))||"0.00"]}),e.jsx(L,{variant:"outline",children:a.category})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsxs("p",{children:["Vendedor: ",((j=a.seller)==null?void 0:j.business_name)||"N/A"]}),e.jsxs("p",{children:["Email: ",((y=(N=a.seller)==null?void 0:N.users)==null?void 0:y.email)||"N/A"]})]}),e.jsxs("div",{className:"flex space-x-2 mt-4",children:[e.jsxs(g,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"Ver"]}),e.jsxs(O,{value:a.status||"active",onValueChange:T=>t(a.id,T),children:[e.jsx(P,{className:"w-20 h-8",children:e.jsx(z,{})}),e.jsxs(U,{children:[e.jsx(n,{value:"active",children:"Activo"}),e.jsx(n,{value:"inactive",children:"Inactivo"}),e.jsx(n,{value:"pending",children:"Pendiente"}),e.jsx(n,{value:"rejected",children:"Rechazado"})]})]}),e.jsxs(he,{children:[e.jsx(me,{asChild:!0,children:e.jsx(g,{variant:"destructive",size:"sm",children:e.jsx(Ce,{className:"w-3 h-3"})})}),e.jsxs(ue,{children:[e.jsxs(je,{children:[e.jsx(ge,{children:"¿Eliminar producto?"}),e.jsx(ve,{children:"Esta acción no se puede deshacer. El producto será eliminado permanentemente."})]}),e.jsxs(pe,{children:[e.jsx(fe,{children:"Cancelar"}),e.jsx(be,{onClick:()=>d(a.id),className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]})})]},a.id)})}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:r.length===0?e.jsxs("div",{children:[e.jsx(re,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No hay productos registrados aún"}),e.jsx("p",{className:"text-sm mt-2",children:"Los productos aparecerán aquí cuando los vendedores los agreguen"})]}):e.jsx("p",{children:"No se encontraron productos que coincidan con los filtros"})})]})]})})}function hs(){const{user:r,signOut:h}=De(),[o,p]=x.useState({totalUsers:0,activeUsers:0,totalBusinesses:0,totalOrders:0,todayRevenue:0,totalDrivers:0,activeDrivers:0,pendingDrivers:0}),[u,w]=x.useState(!0),c=async()=>{try{w(!0);const l=new Date().toISOString().split("T")[0],[t,d,b,s,a,i,j,N]=await Promise.all([v.from("users").select("*",{count:"exact",head:!0}),v.from("users").select("*",{count:"exact",head:!0}).eq("status","active"),v.from("sellers").select("*",{count:"exact",head:!0}),v.from("orders").select("*",{count:"exact",head:!0}).gte("created_at",l),v.from("orders").select("total,status,created_at").gte("created_at",l).eq("status","delivered"),v.from("users").select("*",{count:"exact",head:!0}).eq("role","repartidor"),v.from("users").select("*",{count:"exact",head:!0}).eq("role","repartidor").eq("is_active",!0),v.from("users").select("*",{count:"exact",head:!0}).eq("role","repartidor").eq("is_verified",!1)]),y=t.count??0,T=d.count??0,F=b.count??0,Q=s.count??0,Se=(a.data||[]).reduce((ee,Ae)=>ee+(Ae.total||0),0),_e=i.count??0,Ee=j.count??0,Te=N.count??0;p(ee=>({...ee,totalUsers:y,activeUsers:T,totalBusinesses:F,totalOrders:Q,todayRevenue:Se,totalDrivers:_e,activeDrivers:Ee,pendingDrivers:Te}))}catch(l){console.error("Error fetching admin stats:",l),m.error("Error al cargar estadísticas")}finally{w(!1)}};x.useEffect(()=>{c()},[]);const A=async()=>{try{await h(),m.success("Sesión cerrada")}catch(l){console.error("Error signing out:",l),m.error("Error al cerrar sesión")}},f=async l=>{try{m.loading("Preparando exportación...");let t=[],d="";switch(l){case"users":const{data:j}=await v.from("users").select("*");t=j||[],d="usuarios_trato.csv";break;case"businesses":const{data:N}=await v.from("sellers").select("*, users(name, email, phone)");t=N||[],d="negocios_trato.csv";break;case"orders":const{data:y}=await v.from("orders").select("*, buyer:users!buyer_id(name), seller:sellers!seller_id(business_name)");t=y||[],d="ordenes_trato.csv";break;case"all":t=[{tabla:"usuarios",total:o.totalUsers,activos:o.activeUsers},{tabla:"negocios",total:o.totalBusinesses},{tabla:"ordenes_hoy",total:o.totalOrders,ingresos:o.todayRevenue}],d="resumen_trato.csv";break}if(t.length===0){m.error("No hay datos para exportar");return}const b=k(t),s=new Blob([b],{type:"text/csv"}),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=d,i.click(),window.URL.revokeObjectURL(a),m.success("Datos exportados correctamente")}catch(t){console.error("Error exporting data:",t),m.error("Error al exportar datos")}},k=l=>{if(l.length===0)return"";const t=Object.keys(l[0]);return[t.join(","),...l.map(b=>t.map(s=>`"${b[s]||""}"`).join(","))].join(`
`)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-green-50",children:[e.jsx(Le,{showBanner:!0,enableAutoActivation:!1,showTester:!1}),e.jsx("header",{className:"bg-white/90 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shadow-lg",style:{background:ze.primary},children:e.jsx(oe,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-orange-600 to-green-600 bg-clip-text text-transparent",children:"TRATO Admin"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Panel de Administración"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(L,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Administrador"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(r==null?void 0:r.name)||"Administrador"}),e.jsx("p",{className:"text-xs text-gray-500",children:r==null?void 0:r.email})]}),e.jsx(g,{variant:"outline",onClick:A,children:"Cerrar Sesión"})]})]})})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[e.jsx(H,{title:"Total Usuarios",value:u?"...":o.totalUsers,icon:J,color:G.orange[500],trend:"+12% esta semana",subtitle:`${o.activeUsers} activos`}),e.jsx(H,{title:"Negocios",value:u?"...":o.totalBusinesses,icon:W,color:G.green[500],trend:"+5% este mes"}),e.jsx(H,{title:"Repartidores",value:u?"...":o.totalDrivers,icon:Ne,color:G.orange[400],trend:o.pendingDrivers>0?`${o.pendingDrivers} pendientes`:"Todos verificados",subtitle:`${o.activeDrivers} activos`}),e.jsx(H,{title:"Órdenes Hoy",value:u?"...":o.totalOrders,icon:K,color:G.orange[600],trend:"+18% vs ayer"}),e.jsx(H,{title:"Ingresos Hoy",value:u?"...":`Q${o.todayRevenue.toFixed(2)}`,icon:de,color:G.green[600],trend:"+25% vs ayer"})]}),e.jsxs(_,{className:"mb-6 bg-gradient-to-r from-purple-50 to-blue-50 border-0",children:[e.jsx(R,{children:e.jsxs(D,{className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{children:"Control Operacional TRATO"})]})}),e.jsx(E,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(g,{className:"h-20 flex-col space-y-2 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white",onClick:async()=>{try{const{data:l,error:t}=await v.from("users").update({is_verified:!0,is_active:!0,updated_at:new Date().toISOString()}).eq("role","repartidor").eq("is_verified",!1);if(t)throw t;m.success("Todos los repartidores han sido activados"),c()}catch(l){console.error("Error:",l),m.error("Error al activar repartidores")}},children:[e.jsx(ne,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm font-medium",children:"Activar Repartidores"})]}),e.jsxs(g,{variant:"outline",className:"h-20 flex-col space-y-2 border-2 border-orange-300 hover:bg-orange-50",onClick:async()=>{try{await c(),m.success("Estadísticas actualizadas")}catch(l){console.error("Error:",l),m.error("Error al actualizar")}},children:[e.jsx(B,{className:"w-6 h-6 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium text-orange-700",children:"Actualizar Sistema"})]}),e.jsxs(g,{variant:"outline",className:"h-20 flex-col space-y-2 border-2 border-blue-300 hover:bg-blue-50",onClick:()=>f("all"),children:[e.jsx(ce,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Exportar Datos"})]}),e.jsxs(g,{variant:"outline",className:"h-20 flex-col space-y-2 border-2 border-purple-300 hover:bg-purple-50",onClick:()=>{m.info("Abriendo configuración del sistema...")},children:[e.jsx(ae,{className:"w-6 h-6 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Configurar Sistema"})]})]})})]}),o.pendingDrivers>0&&e.jsx(_,{className:"mb-6 border-orange-200 bg-orange-50",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(X,{className:"w-6 h-6 text-orange-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-orange-800",children:[o.pendingDrivers," Repartidor",o.pendingDrivers>1?"es":""," Pendiente",o.pendingDrivers>1?"s":""," de Aprobación"]}),e.jsx("p",{className:"text-sm text-orange-600",children:"Hay repartidores que necesitan tu aprobación para poder empezar a trabajar."})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{variant:"outline",className:"border-orange-300 text-orange-700 hover:bg-orange-100",onClick:async()=>{try{const{data:l,error:t}=await v.from("users").select("id").eq("role","repartidor").eq("is_verified",!1);if(t)throw t;if(l&&l.length>0){const{error:d}=await v.from("users").update({is_verified:!0,is_active:!0,updated_at:new Date().toISOString()}).eq("role","repartidor").eq("is_verified",!1);if(d)throw d;m.success(`${l.length} repartidor${l.length>1?"es":""} activado${l.length>1?"s":""} exitosamente`),c()}}catch(l){console.error("Error activating drivers:",l),m.error("Error al activar repartidores")}},children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Activar Todos"]}),e.jsx(g,{className:"bg-orange-500 hover:bg-orange-600 text-white",onClick:()=>{const l=document.querySelector('[value="settings"]');l==null||l.click()},children:"Ver Repartidores"})]})]})})}),e.jsxs(Oe,{defaultValue:"monitor",className:"space-y-6",children:[e.jsxs(Pe,{className:"grid w-full grid-cols-6 lg:w-auto lg:grid-cols-6",children:[e.jsxs(q,{value:"monitor",className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{children:"Monitor"})]}),e.jsxs(q,{value:"users",className:"flex items-center space-x-2",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Usuarios"})]}),e.jsxs(q,{value:"businesses",className:"flex items-center space-x-2",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Negocios"})]}),e.jsxs(q,{value:"products",className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Productos"})]}),e.jsxs(q,{value:"orders",className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"Órdenes"})]}),e.jsxs(q,{value:"settings",className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Configuración"})]})]}),e.jsx(I,{value:"monitor",children:e.jsx(Be,{})}),e.jsx(I,{value:"users",children:e.jsx(Me,{})}),e.jsx(I,{value:"businesses",children:e.jsx(Ge,{})}),e.jsx(I,{value:"products",children:e.jsx(Qe,{})}),e.jsx(I,{value:"orders",children:e.jsx(He,{})}),e.jsx(I,{value:"settings",children:e.jsx($e,{})})]})]}),e.jsxs("div",{className:"fixed bottom-6 right-6 space-y-3",children:[e.jsx(g,{className:"w-14 h-14 rounded-full shadow-lg bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white",onClick:()=>f("all"),title:"Exportar todos los datos",children:e.jsx(ce,{className:"w-6 h-6"})}),e.jsx(g,{className:"w-14 h-14 rounded-full shadow-lg bg-gradient-to-r from-orange-500 to-green-500 hover:from-orange-600 hover:to-green-600 text-white",onClick:c,title:"Actualizar estadísticas",children:e.jsx(B,{className:"w-6 h-6"})})]}),e.jsx("footer",{className:"border-t border-gray-200 bg-white/50 backdrop-blur-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"© 2025 TRATO - Panel de Administración"}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsx("span",{children:"Gualán, Guatemala"}),e.jsx("span",{children:"•"}),e.jsx("span",{children:"Sistema Administrativo"})]})]})})})]})}export{hs as AdminDashboard};
