import{g as k,k as G,r as u,a6 as le,j as s,a7 as O,l as I,z as h,y as ue,w as $,x as V,m as de,A as fe,o as C,u as me,s as ge,X as pe,p as be,d as ve,e as xe}from"./index-DROr5LJE.js";import{S as Te}from"./shopping-cart-Cwjf0Z4h.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],qe=k("dollar-sign",he);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ye=k("package",we);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],ze=k("trending-up",Ie);var S="rovingFocusGroup.onEntryFocus",Ce={bubbles:!1,cancelable:!0},R="RovingFocusGroup",[E,L,Re]=le(R),[_e,K]=G(R,[Re]),[Ne,Ae]=_e(R),U=u.forwardRef((e,n)=>s.jsx(E.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(E.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(Fe,{...e,ref:n})})}));U.displayName=R;var Fe=u.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:l,orientation:r,loop:f=!1,dir:m,currentTabStopId:d,defaultCurrentTabStopId:p,onCurrentTabStopIdChange:b,onEntryFocus:o,preventScrollOnEntryFocus:t=!1,...a}=e,i=u.useRef(null),g=ue(n,i),c=$(m),[w=null,_]=V({prop:d,defaultProp:p,onChange:b}),[x,T]=u.useState(!1),N=de(o),oe=L(l),A=u.useRef(!1),[re,P]=u.useState(0);return u.useEffect(()=>{const v=i.current;if(v)return v.addEventListener(S,N),()=>v.removeEventListener(S,N)},[N]),s.jsx(Ne,{scope:l,orientation:r,dir:c,loop:f,currentTabStopId:w,onItemFocus:u.useCallback(v=>_(v),[_]),onItemShiftTab:u.useCallback(()=>T(!0),[]),onFocusableItemAdd:u.useCallback(()=>P(v=>v+1),[]),onFocusableItemRemove:u.useCallback(()=>P(v=>v-1),[]),children:s.jsx(I.div,{tabIndex:x||re===0?-1:0,"data-orientation":r,...a,ref:g,style:{outline:"none",...e.style},onMouseDown:h(e.onMouseDown,()=>{A.current=!0}),onFocus:h(e.onFocus,v=>{const ae=!A.current;if(v.target===v.currentTarget&&ae&&!x){const M=new CustomEvent(S,Ce);if(v.currentTarget.dispatchEvent(M),!M.defaultPrevented){const F=oe().filter(y=>y.focusable),se=F.find(y=>y.active),ie=F.find(y=>y.id===w),ce=[se,ie,...F].filter(Boolean).map(y=>y.ref.current);z(ce,t)}}A.current=!1}),onBlur:h(e.onBlur,()=>T(!1))})})}),B="RovingFocusGroupItem",q=u.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:l,focusable:r=!0,active:f=!1,tabStopId:m,...d}=e,p=O(),b=m||p,o=Ae(B,l),t=o.currentTabStopId===b,a=L(l),{onFocusableItemAdd:i,onFocusableItemRemove:g}=o;return u.useEffect(()=>{if(r)return i(),()=>g()},[r,i,g]),s.jsx(E.ItemSlot,{scope:l,id:b,focusable:r,active:f,children:s.jsx(I.span,{tabIndex:t?0:-1,"data-orientation":o.orientation,...d,ref:n,onMouseDown:h(e.onMouseDown,c=>{r?o.onItemFocus(b):c.preventDefault()}),onFocus:h(e.onFocus,()=>o.onItemFocus(b)),onKeyDown:h(e.onKeyDown,c=>{if(c.key==="Tab"&&c.shiftKey){o.onItemShiftTab();return}if(c.target!==c.currentTarget)return;const w=ke(c,o.orientation,o.dir);if(w!==void 0){if(c.metaKey||c.ctrlKey||c.altKey||c.shiftKey)return;c.preventDefault();let x=a().filter(T=>T.focusable).map(T=>T.ref.current);if(w==="last")x.reverse();else if(w==="prev"||w==="next"){w==="prev"&&x.reverse();const T=x.indexOf(c.currentTarget);x=o.loop?je(x,T+1):x.slice(T+1)}setTimeout(()=>z(x))}})})})});q.displayName=B;var Se={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Ee(e,n){return n!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ke(e,n,l){const r=Ee(e.key,l);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Se[r]}function z(e,n=!1){const l=document.activeElement;for(const r of e)if(r===l||(r.focus({preventScroll:n}),document.activeElement!==l))return}function je(e,n){return e.map((l,r)=>e[(n+r)%e.length])}var De=U,Pe=q,j="Tabs",[Me,He]=G(j,[K]),H=K(),[Ge,D]=Me(j),Y=u.forwardRef((e,n)=>{const{__scopeTabs:l,value:r,onValueChange:f,defaultValue:m,orientation:d="horizontal",dir:p,activationMode:b="automatic",...o}=e,t=$(p),[a,i]=V({prop:r,onChange:f,defaultProp:m});return s.jsx(Ge,{scope:l,baseId:O(),value:a,onValueChange:i,orientation:d,dir:t,activationMode:b,children:s.jsx(I.div,{dir:t,"data-orientation":d,...o,ref:n})})});Y.displayName=j;var Q="TabsList",X=u.forwardRef((e,n)=>{const{__scopeTabs:l,loop:r=!0,...f}=e,m=D(Q,l),d=H(l);return s.jsx(De,{asChild:!0,...d,orientation:m.orientation,dir:m.dir,loop:r,children:s.jsx(I.div,{role:"tablist","aria-orientation":m.orientation,...f,ref:n})})});X.displayName=Q;var J="TabsTrigger",W=u.forwardRef((e,n)=>{const{__scopeTabs:l,value:r,disabled:f=!1,...m}=e,d=D(J,l),p=H(l),b=te(d.baseId,r),o=ne(d.baseId,r),t=r===d.value;return s.jsx(Pe,{asChild:!0,...p,focusable:!f,active:t,children:s.jsx(I.button,{type:"button",role:"tab","aria-selected":t,"aria-controls":o,"data-state":t?"active":"inactive","data-disabled":f?"":void 0,disabled:f,id:b,...m,ref:n,onMouseDown:h(e.onMouseDown,a=>{!f&&a.button===0&&a.ctrlKey===!1?d.onValueChange(r):a.preventDefault()}),onKeyDown:h(e.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&d.onValueChange(r)}),onFocus:h(e.onFocus,()=>{const a=d.activationMode!=="manual";!t&&!f&&a&&d.onValueChange(r)})})})});W.displayName=J;var Z="TabsContent",ee=u.forwardRef((e,n)=>{const{__scopeTabs:l,value:r,forceMount:f,children:m,...d}=e,p=D(Z,l),b=te(p.baseId,r),o=ne(p.baseId,r),t=r===p.value,a=u.useRef(t);return u.useEffect(()=>{const i=requestAnimationFrame(()=>a.current=!1);return()=>cancelAnimationFrame(i)},[]),s.jsx(fe,{present:f||t,children:({present:i})=>s.jsx(I.div,{"data-state":t?"active":"inactive","data-orientation":p.orientation,role:"tabpanel","aria-labelledby":b,hidden:!i,id:o,tabIndex:0,...d,ref:n,style:{...e.style,animationDuration:a.current?"0s":void 0},children:i&&m})})});ee.displayName=Z;function te(e,n){return`${e}-trigger-${n}`}function ne(e,n){return`${e}-content-${n}`}var Oe=Y,$e=X,Ve=W,Le=ee;function Ye({className:e,...n}){return s.jsx(Oe,{"data-slot":"tabs",className:C("flex flex-col gap-2",e),...n})}function Qe({className:e,...n}){return s.jsx($e,{"data-slot":"tabs-list",className:C("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",e),...n})}function Xe({className:e,...n}){return s.jsx(Ve,{"data-slot":"tabs-trigger",className:C("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}function Je({className:e,...n}){return s.jsx(Le,{"data-slot":"tabs-content",className:C("flex-1 outline-none",e),...n})}function We({onNewOrder:e}){const{user:n}=me(),[l,r]=u.useState([]),f=u.useCallback(o=>{try{const t=new(window.AudioContext||window.webkitAudioContext);if(o==="new_order")[220,330,440].forEach((a,i)=>{setTimeout(()=>{const g=t.createOscillator(),c=t.createGain();g.connect(c),c.connect(t.destination),g.frequency.setValueAtTime(a,t.currentTime),g.type="sine",c.gain.setValueAtTime(.3,t.currentTime),c.gain.exponentialRampToValueAtTime(.01,t.currentTime+.3),g.start(t.currentTime),g.stop(t.currentTime+.3)},i*200)});else{const a=t.createOscillator(),i=t.createGain();a.connect(i),i.connect(t.destination),a.frequency.setValueAtTime(300,t.currentTime),a.type="sine",i.gain.setValueAtTime(.2,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.2),a.start(t.currentTime),a.stop(t.currentTime+.2)}}catch(t){console.log("Audio not supported:",t)}},[]),m=u.useCallback(o=>{const t=`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,a={...o,id:t,timestamp:new Date().toISOString(),autoRemove:o.autoRemove!==!1};r(i=>[a,...i.slice(0,4)]),f(o.type),a.autoRemove&&setTimeout(()=>{d(t)},12e4),o.type==="new_order"&&e&&e()},[f,e]),d=u.useCallback(o=>{r(t=>t.filter(a=>a.id!==o))},[]);u.useEffect(()=>{if(!(n!=null&&n.id))return;const o=ge.channel("seller-order-toasts").on("postgres_changes",{event:"INSERT",schema:"public",table:"orders",filter:`seller_id=eq.${n.id}`},t=>{var i;const a=t.new;m({type:"new_order",title:"ðŸ›’ Nueva Orden",message:`Pedido de Q${((i=a.total)==null?void 0:i.toFixed(2))||"0.00"} recibido`,autoRemove:!0})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders",filter:`seller_id=eq.${n.id}`},t=>{const a=t.new,i=t.old;if(a.status!==i.status){let g="",c="order_update";switch(a.status){case"confirmed":g="Orden confirmada exitosamente",c="success";break;case"ready":g="Orden lista para entrega",c="success";break;case"delivered":g="Orden entregada exitosamente",c="success";break;case"cancelled":g="Orden cancelada",c="warning";break;default:return}m({type:c,title:"ðŸ“‹ ActualizaciÃ³n de Orden",message:g,autoRemove:!0})}}).subscribe();return()=>{o.unsubscribe()}},[n==null?void 0:n.id,m]);const p=o=>{switch(o){case"new_order":return s.jsx(Te,{className:"w-5 h-5 text-blue-600"});case"order_update":return s.jsx(ye,{className:"w-5 h-5 text-green-600"});case"success":return s.jsx(xe,{className:"w-5 h-5 text-green-600"});case"warning":return s.jsx(ve,{className:"w-5 h-5 text-yellow-600"});default:return s.jsx(be,{className:"w-5 h-5 text-gray-600"})}},b=o=>{switch(o){case"new_order":return"bg-blue-50 border-blue-200 shadow-lg ring-2 ring-blue-500/20";case"success":return"bg-green-50 border-green-200 shadow-lg ring-2 ring-green-500/20";case"warning":return"bg-yellow-50 border-yellow-200 shadow-lg ring-2 ring-yellow-500/20";default:return"bg-white border-gray-200 shadow-lg"}};return l.length===0?null:s.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm w-full pointer-events-none",children:l.map((o,t)=>s.jsx("div",{className:`
            ${b(o.type)}
            rounded-lg border p-4 pointer-events-auto
            transform transition-all duration-300 ease-in-out
            animate-in slide-in-from-right-2 fade-in-0
            ${t>0?"opacity-90 scale-95":""}
          `,style:{animationDelay:`${t*100}ms`,transform:`translateY(${t*4}px) scale(${1-t*.05})`},children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:p(o.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:o.title}),s.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:o.message}),s.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(o.timestamp).toLocaleTimeString("es-GT",{hour:"2-digit",minute:"2-digit"})})]}),s.jsx("button",{onClick:()=>d(o.id),className:"flex-shrink-0 p-1 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Cerrar notificaciÃ³n",children:s.jsx(pe,{className:"w-4 h-4 text-gray-400"})})]})},o.id))})}export{qe as D,Pe as I,We as M,ye as P,De as R,Ye as T,Qe as a,Xe as b,ze as c,Je as d,K as e};
